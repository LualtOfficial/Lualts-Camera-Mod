using ComputerInterface;
using ComputerInterface.ViewLib;

using LualtsCameraMod.Plugin;
using BodhiDonselaar.EquiCam;

namespace LualtsCameraMod
{
    public class MainView : ComputerView
    {
        // This is called when you view is opened
        public override void OnShow(object[] args)
        {
            base.OnShow(args);
            Text = "Monkey Computer\nMonkey Computer\nMounkey Computer";
        }

        public void UpdateScreen()
        {
            object value = SetText(str =>
            {
                str.BeginCenter();
                str.MakeBar('-', SCREEN_WIDTH, 0, "ffffff10");
                str.AppendClr("Lualt's Camera Mod", titleColour).EndColor().AppendLine();
                str.AppendLine("2.0.0");
                str.MakeBar('-', SCREEN_WIDTH, 0, "ffffff10");
                str.EndAlign().AppendLines(1);
                str.MakeBar(' ', SCREEN_WIDTH, 0, "ffffff10");

                str.AppendLine(selectionHandler.GetIndicatedText(0, "Settings"));
                str.AppendLine();
                str.AppendLine(selectionHandler.GetIndicatedText(1, $"<color={(Plugin.locked ? string.Format("#{0}>[Controls Locked]", titleColour) : "white>[Controls Unlocked]")}</color>"));
                str.AppendLine(selectionHandler.GetIndicatedText(2, $"<color={(EquiCam.enabled ? string.Format("#{0}>[360 Enabled]", titleColour) : "white>[360 Disabled]")}</color>"));

                str.AppendLines(1);
                str.MakeBar(' ', SCREEN_WIDTH, 0, "ffffff10");
            }
            );
        }

        public override void OnKeyPressed(EKeyboardKey key)
        {
            if (selectionHandler.HandleKeypress(key))
            {
                UpdateScreen();
                return;
            }

            switch (key)
            {
                case EKeyboardKey.Delete:
                    // "ReturnToMainMenu" will basically switch to the main menu again
                    ReturnToMainMenu();
                    break;

                case EKeyboardKey.Up:
                    selectionHandler.MoveSelectionUp();
                    UpdateScreen();
                    break;
                case EKeyboardKey.Down:
                    selectionHandler.MoveSelectionDown();
                    UpdateScreen();
                    break;
            }
        }

        private void SelectionHandler_OnSelected(int obj)
        {
            switch (obj)
            {
                case 0:
                    ShowView<SettingsView>;
                    break;
            }

            
        }
    }
}
